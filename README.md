# Разработка полностью связанной нейронной сети с помощью библиотеки MXNet
 ## Решаемая задача
[Набор данных](http://grail.cs.washington.edu/projects/deepexpr/ferg-db.html "dataset description") состоит из изображений лиц 6-ти персонажей. Изображения для каждого персонажа сгруппированы по 7 типовых выражений лица: гнев, отвращение, страх, радость, нейтральное выражение, печаль и удивление. Всего база содержит 55767  изображений лиц шести стилизованных персонажей.

Решалась задача распознавания по имеющимся изображениям определить эмоцию персонажа.

## Метод решения
Были реализованы нейронные сети с 1-3 полносвязными скрытыми слоями. В качестве варьируемого параметра использовалась функция активации нейронов внутренних слоёв, выбор осуществлялся между ReLu и сигмоидальной функцией. На выходном слое при решении задач классификации обычно используется функция Softmax, данная функция всегда остаётся без изменений.

В качестве тренировочного набора данных используем изображения с эмоциями 5 персонажей. В качестве тестового – изображения с эмоциями 6го персонажа. Такое разделение выбрано потму, что разнообразие входных данных невелико – лица персонажей смоделированны с помощью 3-D инструмента, многие изображения датасета отличаются друг от друга незначительно. Было бы интересно посмотреть, насколько хорошо сеть справится с неизвестным ей персонажем.

## Инструкция по сборке
1. Установить интерпретатор Python версии 2.7.x, который можно скачать с [официального сайта](https://www.python.org/downloads/ "python download") или установить его в составе пакета [Anaconda](https://www.anaconda.com/download/ "Anaconda download")

2. Установить необходимые для работы скриптов пакеты: mxnet, opencv-python. Для этого после установки итерпретатора достаточно написать в командной строке:
<pre><code>pip install mxnet
pip install opencv-python
</code></pre>

3. Сформировать .rec файл тренировочной выборки. Для этого, находясь в директории src, надо написать:

4. Сформировать .rec файл тестовой выборки. Для этого, находясь в директории src, надо написать:

5. Запустить скрипт FCNNtrain.py. В папке src после обучения сети появятся .json файлы с сохранёнными значениями весов после обучения, а в консоли будет выведена ошибка на тестовой выборке после каждой эпохи обучения.

